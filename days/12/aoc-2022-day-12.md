# Profiling in Haskell Adventure

## 2023-08-24

- new setup, following: <https://nikita-volkov.github.io/profiling-cabal-projects/>
- `$ cabal configure --enable-library-profiling --enable-executable-profiling --enable-tests --enable-benchmarks`
- in this case, copied .cabal file from test run
  - used settings from link above
  - updated ghc-options that were deprecated
  - added `-prof`
  - changed: `-h` to `-hT`
  - left: `i0.1` alone as I figured it was erroring out due to previous errors
- `$ cabal install --only-dependencies --enable-library-profiling`


---

## 2023-08-23

```
$ ghc -O2 --make day-12.hs -prof -auto-all -caf-all -fforce-recomp
Loaded package environment from /home/me/.ghc/x86_64-linux-9.2.7/environments/default

on the commandline: warning: [-Wdeprecated-flags]
    -auto-all is deprecated: Use -fprof-auto instead

on the commandline: warning: [-Wdeprecated-flags]
    -caf-all is deprecated: Use -fprof-cafs instead
[1 of 1] Compiling Main             ( day-12.hs, day-12.o )

day-12.hs:65:1: error:
    Could not find module ‘Data.Vector’
    Perhaps you haven't installed the profiling libraries for package ‘vector-0.13.0.0’?
    Use -v (or `:set -v` in ghci) to see a list of the files searched for.
   |
65 | import Data.Vector (Vector)
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^

day-12.hs:66:1: error:
    Could not find module ‘Data.Vector’
    Perhaps you haven't installed the profiling libraries for package ‘vector-0.13.0.0’?
    Use -v (or `:set -v` in ghci) to see a list of the files searched for.
   |
66 | import qualified Data.Vector as V
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
```

---

```
$ ghc-pkg list | grep vector 
me at me-Ame-A10 in ~/cs/aoc/AoC-2022/days/12 on day-12-profiling
$ cabal update && cabal install vector 
Downloading the latest package list from hackage.haskell.org
Updated package list of hackage.haskell.org to the index-state 2023-08-24T00:43:23Z
To revert to previous state run:
    cabal v2-update 'hackage.haskell.org,2023-08-08T19:56:09Z'
Resolving dependencies...
Up to date
Warning:
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@ WARNING: Installation might not be completed as desired! @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The command "cabal install [TARGETS]" doesn't expose libraries.
* You might have wanted to add them as dependencies to your package. In this
case add "vector" to the build-depends field(s) of your package's .cabal file.
* You might have wanted to add them to a GHC environment. In this case use
"cabal install --lib vector". The "--lib" flag is provisional: see
https://github.com/haskell/cabal/issues/6481 for more information.
```

---

but, `$ ghc -O2 day-12.hs` compiles just fine!

---

```
$ ghc -O2 --make day-12.hs -prof -fprof-auto -fprof-cafs -fforce-recomp
Loaded package environment from /home/me/.ghc/x86_64-linux-9.2.7/environments/default
[1 of 1] Compiling Main             ( day-12.hs, day-12.o )

day-12.hs:65:1: error:
    Could not find module ‘Data.Vector’
    Perhaps you haven't installed the profiling libraries for package ‘vector-0.13.0.0’?
    Use -v (or `:set -v` in ghci) to see a list of the files searched for.
   |
65 | import Data.Vector (Vector)
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^

day-12.hs:66:1: error:
    Could not find module ‘Data.Vector’
    Perhaps you haven't installed the profiling libraries for package ‘vector-0.13.0.0’?
    Use -v (or `:set -v` in ghci) to see a list of the files searched for.
   |
66 | import qualified Data.Vector as V
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
```

---

`$ cabal init`

---

`$ cabal build`

---

```
$ cd days/12
$ cabal run
Up to date
Hello, Haskell!
```

